<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="Michael Simons">
<title>An introduction to Spring Boot</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body class="article">
<div id="header">
<h1>An introduction to Spring Boot</h1>
<div class="details">
<span id="author" class="author">Michael Simons</span><br>
<span id="email" class="email"><a href="mailto:michael@simons.ac">michael@simons.ac</a></span><br>
<span id="revnumber">version 1.0,</span>
<span id="revdate">2017-06-30 16:50:00 CEST</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>&#169; 2017 The original authors.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<em>Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically.</em>
</td>
</tr>
</table>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_abstract">1. Abstract</a></li>
<li><a href="#_setup">2. Setup</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites">2.1. Prerequisites</a></li>
<li><a href="#_register_a_github_account_optional_recommended">2.2. Register a GitHub account (Optional, recommended)</a></li>
<li><a href="#clone-the-repo">2.3. Clone the repository</a></li>
<li><a href="#_prepare_your_ide">2.4. Prepare your IDE</a></li>
</ul>
</li>
<li><a href="#_create_a_new_spring_boot_project">3. Create a new Spring Boot project</a>
<ul class="sectlevel2">
<li><a href="#_use_the_spring_initializr">3.1. Use the Spring Initializr</a></li>
</ul>
</li>
<li><a href="#_explore_your_first_spring_boot_project">4. Explore your first Spring Boot project</a>
<ul class="sectlevel2">
<li><a href="#_the_build_file">4.1. The build file</a></li>
<li><a href="#_the_main_class">4.2. The main class</a></li>
<li><a href="#_the_package_structure">4.3. The package structure</a></li>
<li><a href="#_the_test_sources">4.4. The test sources</a></li>
</ul>
</li>
<li><a href="#_add_some_content">5. Add some content</a>
<ul class="sectlevel2">
<li><a href="#_spring_boot_developer_tools">5.1. Spring Boot Developer Tools</a></li>
<li><a href="#_spring_boot_starter_jpa">5.2. Spring Boot Starter JPA</a></li>
<li><a href="#_web_layer">5.3. Web layer</a></li>
<li><a href="#_database_layer">5.4. Database layer</a></li>
</ul>
</li>
<li><a href="#_configuration_of_spring_boot_applications">6. Configuration of Spring Boot Applications</a>
<ul class="sectlevel2">
<li><a href="#_external_configuration">6.1. External configuration</a></li>
</ul>
</li>
<li><a href="#_non_functional_requirements">7. Non functional requirements</a></li>
<li><a href="#_microservice_scenario">8. Microservice Scenario</a></li>
<li><a href="#_wrap_up">9. Wrap up</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_abstract"><a class="anchor" href="#_abstract"></a>1. Abstract</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this workshop we&#8217;ll work on a application that deals with events (like talks, conferences and so on). The scope of the application is to store those events and provide an API for retrieving, manipulating and updating events.</p>
</div>
<div class="paragraph">
<p>If we&#8217;ll have some time left, we also gonna see a short demo how to orchestrate that as a microservice for a calendar application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setup"><a class="anchor" href="#_setup"></a>2. Setup</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>2.1. Prerequisites</h3>
<div class="paragraph">
<p>You need an installed JDK, at least Java 8. If you use <a href="https://git-scm.com/">Git</a>, then you can checkout the Code using Git.</p>
</div>
<div class="paragraph">
<p>The project in this workshop will be a <a href="https://maven.apache.org">Maven</a> project. It contains the Maven wrapper, so you don&#8217;t have to install Maven by hand if you don&#8217;t have a recent copy.</p>
</div>
<div class="paragraph">
<p>An installed IDE is recommended but not necessary. Having <code>cURL</code>, a browser or, any other sophisticated HTTP client installed is beneficial for issuing HTTP requests.</p>
</div>
<div class="paragraph">
<p>As Spring Boot Project is a plain Gradle or Maven Project in the end, all three major IDEs (<a href="https://netbeans.org">NetBeans</a>, <a href="https://spring.io/tools/sts">Eclipse / Spring Tool Suite</a> and <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a>) can open and compile them. Additional support like code completion for configuration files, request mappings, dashboards and so on vary from IDE to IDE. You have to decide what you want and need.</p>
</div>
<div class="paragraph">
<p>If you want to try out the microservice examples in Docker, you&#8217;ll need a recent Docker installation on your machine, too.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If you don&#8217;t have docker installed, the projects won&#8217;t build after commit #445fcec. I have tagged the latest version that works without docker for you, so you can check it out with <code>git checkout no-docker</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_downloads"><a class="anchor" href="#_downloads"></a>Downloads</h4>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">Oracle JDK</a>, please choose your operating system</p>
</li>
<li>
<p><a href="https://git-scm.com">Git</a></p>
</li>
<li>
<p>One of those:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://spring.io/tools/sts">Spring Tool Suite</a></p>
</li>
<li>
<p><a href="https://netbeans.org">NetBeans</a> with <a href="https://github.com/AlexFalappa/nb-springboot">NB-SpringBoot</a></p>
</li>
<li>
<p><a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://www.docker.com/community-edition#/download">Docker Community Edition</a>, please choose your operating system</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_register_a_github_account_optional_recommended"><a class="anchor" href="#_register_a_github_account_optional_recommended"></a>2.2. Register a GitHub account (Optional, recommended)</h3>
<div class="paragraph">
<p>Go to <a href="https://github.com" class="bare">https://github.com</a> and signup for a free account. If you already have a GitHub account, you can skip this step.</p>
</div>
</div>
<div class="sect2">
<h3 id="clone-the-repo"><a class="anchor" href="#clone-the-repo"></a>2.3. Clone the repository</h3>
<div class="paragraph">
<p>The code of this project will be available at GitHub at <a href="https://github.com/michael-simons/ws-20170627-cluj" class="bare">https://github.com/michael-simons/ws-20170627-cluj</a> after the workshop.</p>
</div>
</div>
<div class="sect2">
<h3 id="_prepare_your_ide"><a class="anchor" href="#_prepare_your_ide"></a>2.4. Prepare your IDE</h3>
<div class="paragraph">
<p>Choose one of</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spring Tool Suite (STS) from <a href="https://spring.io/tools" class="bare">https://spring.io/tools</a></p>
</li>
<li>
<p>NetBeans from <a href="https://netbeans.org" class="bare">https://netbeans.org</a></p>
</li>
<li>
<p>Eclipse from <a href="https://www.eclipse.org" class="bare">https://www.eclipse.org</a></p>
</li>
<li>
<p>IntelliJ IDEA from <a href="https://www.jetbrains.com/idea/" class="bare">https://www.jetbrains.com/idea/</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Even though Spring Boot projects are just regular Maven Projects, you&#8217;ll get some perks from IDEs, for example direct integration with Spring Boots initializer, recognition of Spring Boots configuration, Spring Beans and more.</p>
</div>
<div class="paragraph">
<p>STS and IntelliJ offer the most complete support, however in the case of IntelliJ only the ultimate edition does.</p>
</div>
<div class="paragraph">
<p>STS is completely free. You can get its integration into Eclipse as well from the marketplace, but I&#8217;ll recommend using STS directly.</p>
</div>
<div class="paragraph">
<p>NetBeans is one of the best choices for Maven projects. It also features direct support of project Lombok for example. If you&#8217;re a NetBeans user, I&#8217;ll highly recommend to install <em>NB-SpringBoot</em> from the plugin page or directly from NetBeans through <span class="menuseq"><span class="menu">Tools</span>&#160;&#9656; <span class="submenu">Plugins</span>&#160;&#9656; <span class="menuitem">Available Plugins</span></span>. Find more information on the plugin here: <a href="https://github.com/AlexFalappa/nb-springboot" class="bare">https://github.com/AlexFalappa/nb-springboot</a>.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll discover some features of NetBeans, STS and IntelliJ on the way through the workshop, but let me assure you once again: Spring Boot projects are just plain normal Maven or Gradle projects.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_a_new_spring_boot_project"><a class="anchor" href="#_create_a_new_spring_boot_project"></a>3. Create a new Spring Boot project</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this part you&#8217;ll learn about the different ways to bootstrap a Spring Boot application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As you have learned in the introduction, Spring Boot projects are basically Spring projects that just happend to configure stuff in a way that seems "magically" at first look. This configuration comes in the form of a parent project in the case of Maven and in the form of a plugin if you&#8217;re a Gradle user.</p>
</div>
<div class="paragraph">
<p>You can write the build file by hand or you just can go to <a href="https://start.spring.io">start.spring.io</a> and have the Spring Initializr generate it for you.</p>
</div>
<div class="sect2">
<h3 id="_use_the_spring_initializr"><a class="anchor" href="#_use_the_spring_initializr"></a>3.1. Use the Spring Initializr</h3>
<div class="sect3">
<h4 id="initializr-website"><a class="anchor" href="#initializr-website"></a>Through the website</h4>
<div class="paragraph">
<p><strong>Steps</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to <a href="https://start.spring.io" class="bare">https://start.spring.io</a>, chose wether you want to use Maven or Gradle, the language (in this workshop we&#8217;ll use Java) and the version of Spring Boot (leave as is).</p>
</li>
<li>
<p>Enter "Web" inside dependencies textbox and select "Web"</p>
</li>
<li>
<p>Repeat last steps with the technologies you&#8217;ll find interesting</p>
</li>
<li>
<p>Hit generate</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Your browser downloads a Zipfile with your project. You can unzip this with a tool of your choice and already start your application:</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Unzip and start the first demo</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell">unzip demo.zip
cd demo
./mvnw spring-boot:run</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To explore the generated buildfile and the minimal application skeleton generated, we&#8217;re repeat the steps inside an IDE.</p>
</div>
</div>
<div class="sect3">
<h4 id="_from_an_ide"><a class="anchor" href="#_from_an_ide"></a>From an IDE</h4>
<div class="sect4">
<h5 id="_spring_tools_suite"><a class="anchor" href="#_spring_tools_suite"></a>Spring Tools Suite</h5>
<div class="paragraph">
<p><strong>Steps</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Choose <span class="menuseq"><span class="menu">File</span>&#160;&#9656; <span class="submenu">New</span>&#160;&#9656; <span class="menuitem">Spring Starter Project</span></span></p>
</li>
<li>
<p>Enter <code>event-service</code> as a name</p>
</li>
<li>
<p>Enter <code>ac.simons.ws.cluj:events</code> as coordinates (feel free to chose whatever you like, though. However: this document and the finished project will refer to those coordinates)</p>
</li>
<li>
<p>Enter some appropriate description and name</p>
</li>
<li>
<p>Clear the package name</p>
</li>
<li>
<p>Hit next and chose "Web" as dependency</p>
</li>
<li>
<p>Hit either finish or next. Next gives you a handy URL that can be used to reference exactly the options you used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Wait a second until STS automatically opens your project.</p>
</div>
</div>
<div class="sect4">
<h5 id="_netbeans"><a class="anchor" href="#_netbeans"></a>NetBeans</h5>
<div class="paragraph">
<p>The steps are basically the same, but you have to have the NB-SpringBoot-Plugin installed.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Choose <span class="menuseq"><span class="menu">File</span>&#160;&#9656; <span class="submenu">New Projectâ€¦</span>&#160;&#9656; <span class="submenu">Maven</span>&#160;&#9656; <span class="menuitem">Spring Initializr Project</span></span></p>
</li>
<li>
<p>Enter your coordinates and description as described above</p>
</li>
<li>
<p>Choose dependencies as described before</p>
</li>
<li>
<p>Select a location</p>
</li>
<li>
<p>Uncheck <em>Remove Maven Wrapper</em> if you want to keep the Maven Wrapper inside the generated project (which is useful, if you ask me)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You&#8217;re done.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll notice that neither STS nor NetBeans store a lot of IDE specific stuff. Both have some project specific settings, like which is the main class and so on, but that&#8217;s basically it. You can run both projects from the command line.</p>
</div>
</div>
<div class="sect4">
<h5 id="_intellij_idea_ultimate_edition"><a class="anchor" href="#_intellij_idea_ultimate_edition"></a>IntelliJ IDEA Ultimate Edition</h5>
<div class="paragraph">
<p>Again, the same steps. Hit "Create new project", choose "Spring Initializr" and follow the dialog.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_with_curl_or_other_tools"><a class="anchor" href="#_with_curl_or_other_tools"></a>With cURL or other tools</h4>
<div class="paragraph">
<p>The Spring Initializr is completely scriptable. It speaks Hypertext Application Language (HAL) and you can get an overview about its options by just curling it:</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Retrive the metadata of Spring Initializr</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell">curl -H 'Accept: application/json' https://start.spring.io</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Find a complete documentation at <a href="http://docs.spring.io/initializr/docs/current/reference/htmlsingle/#metadata-format">docs.spring.io/initializr</a>. The example from <a href="#initializr-website">the beginning of this chapter</a> also be created via</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Use Spring Initializr from the command line</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell">curl https://start.spring.io/starter.zip -d dependencies=web -o demo.zip
unzip demo.zip -d demo
cd demo
./mvnw spring-boot:run</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Explore the manual linked above. You can install a custom copy of the Initializr if you want to. Scripting it might be a valuable tool for your process.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_explore_your_first_spring_boot_project"><a class="anchor" href="#_explore_your_first_spring_boot_project"></a>4. Explore your first Spring Boot project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you didn&#8217;t follow the steps above, now it&#8217;s time to open the project <code>event-service</code>. Navigate to the folder that you used while <a href="#clone-the-repo">cloning the repository</a> and open the project with your IDE of choice.</p>
</div>
<div class="sect2">
<h3 id="_the_build_file"><a class="anchor" href="#_the_build_file"></a>4.1. The build file</h3>
<div class="paragraph">
<p>First check out the <code>pom.xml</code>. Note that it defines a parent through</p>
</div>
<div class="exampleblock">
<div class="title">Example 4. Standard Spring Boot projects inherited from Spring Boots parent pom</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;parent&gt;
	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
	&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
	&lt;version&gt;1.5.4.RELEASE&lt;/version&gt;
	&lt;relativePath/&gt;
&lt;/parent&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then follow some properties. Have a look at <code>java.version</code>. Its set to 1.8 by default. You don&#8217;t have to configure Mavens compiler plugin. The parent does that for you.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Boot prior to 2 supports Java 7 and 8 (Java 6 with some workarounds), Spring Boot 2 needs Java 8 and will support Java 9.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_build_in_dependency_management"><a class="anchor" href="#_build_in_dependency_management"></a>Build-in dependency management</h4>
<div class="paragraph">
<p>Then follow the dependencies, which we just declared:</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. Some Spring Boot dependencies</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
	&lt;dependency&gt;
		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
		&lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
		&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
	&lt;/dependency&gt;

	&lt;dependency&gt;
		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
		&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
		&lt;scope&gt;test&lt;/scope&gt;
	&lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Noticeable here is the lack of version numbers. That has been taken care of by the Spring and Spring Boot teams: They chose versions of libraries that work well together and put them in their parent pom in a section <code>&lt;dependencyManagement /&gt;</code> Now everytime you need one of those, you can skip the version number.</p>
</div>
<div class="paragraph">
<p>If you want to override a version, you can do that too via a property declared like the Java version. Later in the example we&#8217;re gonna use Flyway and declare it like so</p>
</div>
<div class="exampleblock">
<div class="title">Example 6. Another dependency without explicit version</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;org.flywaydb&lt;/groupId&gt;
	&lt;artifactId&gt;flyway-core&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you want to use a version other than Spring Boot uses, you wouldn&#8217;t overwrite it in the dependency but declare a property:</p>
</div>
<div class="exampleblock">
<div class="title">Example 7. Overwriting versions via properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;properties&gt;
	&lt;flyway.version&gt;4.2.0&lt;/flyway.version&gt;
&lt;/properties&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="__starter"><a class="anchor" href="#__starter"></a>"Starter"</h4>
<div class="paragraph">
<p>What the hell are starter? Those are "meta-dependencies". They usually consist of an autoconfigure module that has code for configuring certain aspects of a framework module or library. Usually that autoconfigure module depends only optional on the framework module or library. The starter module itself depends on the autoconfiguration as well as on the libraries.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_main_class"><a class="anchor" href="#_the_main_class"></a>4.2. The main class</h3>
<div class="paragraph">
<p>Depending on how you parameterized the initializer, your main class will be named differently. In the example project it is <code>EventServiceApplication</code>, named after the coordinates you entered and located in the package, which you entered explicitly. The class looks pretty innocent:</p>
</div>
<div class="exampleblock">
<div class="title">Example 8. A default Spring Boot main class</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package ac.simons.ws.cluj.events;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class EventServiceApplication {

	public static void main(String[] args) {
		SpringApplication.run(EventServiceApplication.class, args);
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The main method is interesting, because it delegates to a static helper method inside <code>SpringApplication</code> that does all the heavy lifting of initializing the Spring context.</p>
</div>
<div class="paragraph">
<p>But where does the configuration come from? Explore the <code>@SpringBootApplication</code> annotation. It&#8217;s a composed annotation that looks like this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 9. Abbreviated source of <code>@SpringBootApplication</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@SpringBootConfiguration
@EnableAutoConfiguration
@ComponentScan
public @interface SpringBootApplication{}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This annotation combines several others:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@SpringBootConfiguration</code> marks the class as a configuration class. <code>@SpringBootConfiguration</code> is special in so far that there should be only one of those throughout one context whereas <code>@Configuration</code> classes can be many</p>
</li>
<li>
<p><code>@EnableAutoConfiguration</code> enables the "magic" of Spring Boot: It looks for <code>@Configuration</code> classes that are marked as autoconfiguration and loads them fully or partially, depending on wether certain conditions are fulfilled or not.</p>
</li>
<li>
<p><code>@ComponentScan</code> finally kicks of the search for Spring components. Those are <code>@Controller</code>, <code>@Services</code> and many others</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As you can see, the application class has a main method and therefor can be used for a runnable jar file. Part of Spring Boots philosophy is to provide single fat jars as deployment artifacts.</p>
</div>
<div class="paragraph">
<p>As we have declared the WEB dependency and got the <code>spring-boot-starter-web</code>, we also have an embedded Tomcat on the classpath.</p>
</div>
<div class="paragraph">
<p>However, you can also choose to deploy Spring Boot applications as war. If you had chose 'WAR' as packaging type in the initializer, it would have created an additional <code>SpringBootServletInitializer</code> that facilitates Springs SPI for <code>ServletContainerInitializer</code>.</p>
</div>
<div class="paragraph">
<p>How does that work with the embedded tomcat? There are Maven and Gradle plugins that repackages the artifact to be a "fat jar" or "fat war". The "main" class we have written isn&#8217;t directly called, but a Spring Boot loader class.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_package_structure"><a class="anchor" href="#_the_package_structure"></a>4.3. The package structure</h3>
<div class="paragraph">
<p>At the moment, there&#8217;s only one class, the application class. The package is based on the project coordinates. The package structure is actually already important here as the application class is annotated with <code>@ComponentScan</code>. This annotations searches for Spring components from the package the annotated class declares downwards.</p>
</div>
<div class="paragraph">
<p>There are two caveats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Don&#8217;t annotate a class in the root package with <code>@SpringBootApplication</code> or <code>@ComponentScan</code>. It will scan the whole class path!</p>
</li>
<li>
<p>Those annotation won&#8217;t scan packages in parallel to their current package</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>How about the configuration in starter than? Does Spring actually run a full classpath package scan? No: It uses the <code>spring.factories</code> services locator implementation!</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_test_sources"><a class="anchor" href="#_the_test_sources"></a>4.4. The test sources</h3>
<div class="paragraph">
<p>The initializer already generated a test:</p>
</div>
<div class="exampleblock">
<div class="title">Example 10. Generated test</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RunWith(SpringRunner.class)
@SpringBootTest
public class EventServiceApplicationTests {

	@Test
	public void contextLoads() {
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Its a standard JUnit 4 test that is run with a special runner, the <code>SpringRunner</code> and marked as <code>@SpringBootTest</code>. The later denotes a full integration test: Loading the embedded web container (if any) and all connections to third party services.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_add_some_content"><a class="anchor" href="#_add_some_content"></a>5. Add some content</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_spring_boot_developer_tools"><a class="anchor" href="#_spring_boot_developer_tools"></a>5.1. Spring Boot Developer Tools</h3>
<div class="paragraph">
<p>Let&#8217;s add a nice runtime dependency call "Spring Boot Developer Tools", "devtools" for short:</p>
</div>
<div class="exampleblock">
<div class="title">Example 11. Declare Spring Boot devtools</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
	&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
	&lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This is a not a compile time but a runtime dependency that has several neat features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the application is run from an IDE or with the Maven or Gradle plugin, it restarts the context when classes changes</p>
</li>
<li>
<p>It automatically reloads changed resources</p>
</li>
<li>
<p>Changes some settings during development, for example disables caching for messages, templates and so on</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Itâ€™s not as elaborate like JRebel, but, nevertheless, valuable!</p>
</div>
</div>
<div class="sect2">
<h3 id="_spring_boot_starter_jpa"><a class="anchor" href="#_spring_boot_starter_jpa"></a>5.2. Spring Boot Starter JPA</h3>
<div class="paragraph">
<p>We have to store some stuff. <code>org.springframework.boot:spring-boot-starter-data-jpa</code> is a handy starter that brings you among others:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hibernate Core</p>
</li>
<li>
<p>Hibernate Entity Manager</p>
</li>
<li>
<p>Spring JDBC</p>
</li>
<li>
<p>Spring Data Commons</p>
</li>
<li>
<p>Spring Data JPA</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="data-jpa-deps.png" alt="data jpa deps">
</div>
</div>
<div class="paragraph">
<p>We gonna deep dive into this later. First step is to declare a simple entity for storing events:</p>
</div>
<div class="exampleblock">
<div class="title">Example 12. Simple JPA entity</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Entity
@Table(
        name = "events",
        uniqueConstraints = {
            @UniqueConstraint(name = "events_uk", columnNames = {"held_on", "name"})
        }
)
public class EventEntity implements Serializable {

    private static final long serialVersionUID = 2005305860095134425L;

    public enum Status {

        open, closed
    }

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Integer id;

    @Column(name = "held_on", nullable = false)
    @Temporal(TemporalType.TIMESTAMP)
    private Calendar heldOn;

    @Column(length = 512, nullable = false)
    private String name;

    @Column(name = "created_at", nullable = false)
    @Temporal(TemporalType.TIMESTAMP)
    private Calendar createdAt;

    @Enumerated(EnumType.STRING)
    private Status status;

    protected EventEntity() {
    }

    public EventEntity(final Calendar heldOn, final String name) {
        this.heldOn = heldOn;
        this.name = name;
        this.status = Status.open;
    }

    @PrePersist
    @PreUpdate
    void prePersistAndUpdate() {
        if (this.createdAt == null) {
            this.createdAt = Calendar.getInstance();
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As you can see: Nothing apart from Hibernate specific annotations and nothing fancy here.</p>
</div>
<div class="paragraph">
<p>Using Spring with Spring Boot and the JPA starter you don&#8217;t have to worry about a persistence unit. Spring Boot takes care of</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Collecting all entity classes and related classes</p>
</li>
<li>
<p>Provides a datasource</p>
</li>
<li>
<p>Provides local transaction management for that datasource</p>
</li>
<li>
<p>Provides an EntityManagerFactory</p>
</li>
<li>
<p>Provides a thread safe entity manager, independent wether JTA or application based transactions are used &#8594; You can omit <code>@PersistenceContext</code> annotation which works on attributes only</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_web_layer"><a class="anchor" href="#_web_layer"></a>5.3. Web layer</h3>
<div class="paragraph">
<p>We already have all the dependencies we need to work on the web layer, so we can add a controller that should take care of handling events:</p>
</div>
<div class="exampleblock">
<div class="title">Example 13. Empty Spring Web MVC controller</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RestController
public class EventApi {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Nothing there yet, we&#8217;re gonna develop the controller in a test driven way.</p>
</div>
<div class="paragraph">
<p>Inside your test sources create a class <code>EventApiTest</code> in the same package as your controller having the following content:</p>
</div>
<div class="exampleblock">
<div class="title">Example 14. Test the controller above</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RunWith(SpringRunner.class)
@WebMvcTest
public class EventApiTest {
    @Test
    public void getEventsShouldWork() {
        // Actually test something ;)
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>What do we have here: Again a Spring JUnit Test, but this time <code>@WebMvcTest</code>. This annotation is called a <em>test slice</em>. It only configures infrastructure and Spring components essential for that technical slice. In this case: The web layer.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@WebMvcTest</code> first scans the package of the test class for a context configuration. If it doesn&#8217;t find a class with <code>@SpringBootApplication</code> it uses the same rules as the Spring Framework itself, i.e. it looks also for XML and Groovy based configuration. If that isn&#8217;t successful, it also scans the class path "upwards", so it finds your main Spring Boot class even if you have put away your controllers inside a subpackage.
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="title">Example 15. First iteration of the test</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Autowired
private MockMvc mvc;

@Test
public void getEventsShouldWork() throws Exception {
    this.mvc
            .perform(MockMvcRequestBuilders.get("/api/events"))
            .andExpect(MockMvcResultMatchers.status().isOk());
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>That first approach uses an instance of <code>MockMvc</code> provided by <code>@WebMvcTest</code> to call the events api and expects a status 200 (ok). That test obviously fails. Let&#8217;s make this work by adding one method to the controller:</p>
</div>
<div class="exampleblock">
<div class="title">Example 16. Fix the failing test</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@GetMapping("/api/events")
public List&lt;EventEntity&gt; getEvents() {
    return new ArrayList&lt;&gt;();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now run the test again and see it turn green!</p>
</div>
<div class="paragraph">
<p>We can easily break it again by actually checking the result:</p>
</div>
<div class="exampleblock">
<div class="title">Example 17. Break the test again!</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Test
public void getEventsShouldWork() throws Exception {
    this.mvc
            .perform(MockMvcRequestBuilders.get("/api/events"))
            .andExpect(MockMvcResultMatchers.status().isOk())
            .andExpect(MockMvcResultMatchers.jsonPath("$[0].name", equalTo("test1")));
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This one checks if the returned content is actually valid. Naive implementation would be hitting the entity manager from within the controller but how could we test just the controller and keeping away from the database? Let&#8217;s introduce a service:</p>
</div>
<div class="exampleblock">
<div class="title">Example 18. Simple service that does the heavy lifting for us</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Service
public class EventService {
    public List&lt;EventEntity&gt; allEvents() {
        return new ArrayList&lt;&gt;();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This class is picked up by the Spring context and can be injected into other beans. Lets cleanup the controller in the way:</p>
</div>
<div class="exampleblock">
<div class="title">Example 19. Revamped controller</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RestController
@RequestMapping("/api/events")
public class EventApi {
    private final EventService eventService;

    public EventApi(EventService eventService) {
        this.eventService = eventService;
    }

    @GetMapping
    public List&lt;EventEntity&gt; getEvents() {
        return this.eventService.allEvents();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You see only annotations relevant to Spring Web MVC. Try running the test know: It doesn&#8217;t even start any more: The Service is not part of the webslice! Spring Boot actually helps you a lot here with its failure analyzers:</p>
</div>
<div class="exampleblock">
<div class="title">Example 20. Failure analysis</div>
<div class="content">
<div class="literalblock">
<div class="content">
<pre>Error starting ApplicationContext. To display the auto-configuration report re-run your application with 'debug' enabled.
2017-06-19 12:07:57.297 ERROR 73221 --- [           main] o.s.b.d.LoggingFailureAnalysisReporter   :

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 0 of constructor in ac.simons.ws.cluj.events.EventApi required a bean of type 'ac.simons.ws.cluj.events.EventService' that could not be found.


Action:

Consider defining a bean of type 'ac.simons.ws.cluj.events.EventService' in your configuration.</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Instead of providing the real bean, we&#8217;re gonna use <code>@MockBean</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 21. Providing collaborateurs through <code>@MockBean</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RunWith(SpringRunner.class)
@WebMvcTest
public class EventApiTest {

    @Autowired
    private MockMvc mvc;

    @MockBean
    private EventService eventService;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>That would be possible on class level, too, but we&#8217;re gonna need that been together with the Mockito support that the dependency on <code>org.springframework.boot:spring-boot-starter-test</code> brought:</p>
</div>
<div class="exampleblock">
<div class="title">Example 22. Prepare the mock</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">ZonedDateTime now = ZonedDateTime.now();
        List&lt;EventEntity&gt; expectedEvents
                = Arrays.asList(
                        new EventEntity(GregorianCalendar.from(now.plusDays(3)), "test1"),
                        new EventEntity(GregorianCalendar.from(now.plusWeeks(1)), "test2")
                );
        Mockito.when(eventService.allEvents()).thenReturn(expectedEvents);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_database_layer"><a class="anchor" href="#_database_layer"></a>5.4. Database layer</h3>
<div class="paragraph">
<p>Now that we have tested the web layer, we&#8217;ll move back again to the database. Together with the Spring Data JPA dependencies we have added <code>com.h2database:h2</code> as a runtime dependencies. Spring Boot configures an in-memory instance of H2 if no other database connection is configured. So, we already have a datasource.</p>
</div>
<div class="paragraph">
<p>Where does the schema come from? Spring Boot configures <code>spring.jpa.hibernate.ddl-auto</code> for you: It uses <code>create-drop</code> on an embedded database, <code>none</code> otherwise which is a sensible default.</p>
</div>
<div class="paragraph">
<p>Spring Boot also takes <code>schema.sql</code> and <code>data.sql</code> scripts in the root of the classpath in consideration. If there is a <code>schema.sql</code> Spring uses that for database initialization <strong>before</strong> <code>data.sql</code> <strong>and</strong> before JPA. If there&#8217;s only <code>data.sql</code>, Spring Boot uses first JPA to generate schema and than the script.</p>
</div>
<div class="paragraph">
<p>In the example we&#8217;re gonna use <code>data.sql</code> only and let Hibernate generate the schema for us.</p>
</div>
<div class="paragraph">
<p>First of all we&#8217;re gonna rework the generated test. By default it&#8217;s only mocking the web environment. Let&#8217;s start in on a random port through <code>@SpringBootTest(webEnvironment = RANDOM_PORT)</code>. That gives also a <code>TestRestTemplate</code> that makes calling our a API a breeze:</p>
</div>
<div class="exampleblock">
<div class="title">Example 23. Test first, again</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = RANDOM_PORT)
public class EventServiceApplicationTests {

    @Autowired
    private TestRestTemplate restTemplate;

    @Test
    public void getEventsShouldWork() {
        final List&lt;EventEntity&gt; events = this.restTemplate.exchange(
                "/api/events",
                HttpMethod.GET,
                null,
                new ParameterizedTypeReference&lt;List&lt;EventEntity&gt;&gt;() {}
        ).getBody();
        assertThat(
                events.get(0).getName(),
                is(equalTo("Get the most out of your data layer"))
        );
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The test fails as expected, but safely assuming we do have some content now, let&#8217;s fill the service with life and make the test work:</p>
</div>
<div class="exampleblock">
<div class="title">Example 24. Event service based on plain JPA database access</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Service
public class EventService {
    private final EntityManager entityManager;

    public EventService(EntityManager entityManager) {
        this.entityManager = entityManager;
    }

    @Transactional(readOnly = true)
    public List&lt;EventEntity&gt; allEvents() {
        return this.entityManager
                .createQuery(
                        "Select event from EventEntity event order by event.heldOn",
                        EventEntity.class
                )
                .getResultList();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And green again!</p>
</div>
<div class="sect3">
<h4 id="_using_a_repository_abstraction"><a class="anchor" href="#_using_a_repository_abstraction"></a>Using a repository abstraction</h4>
<div class="paragraph">
<p>Your service should have to deal with the persistence storage on it&#8217;s own, meaning, it should have no knowledge of the underlaying technology.</p>
</div>
<div class="paragraph">
<p>The repository pattern fixes that. Implemented in Spring Data JPA it takes away the burden of interacting with the persistence layer in many cases.</p>
</div>
<div class="paragraph">
<p>The abstraction is in so far leaking that you get JPA entites out of a JPA repository and Mongo documents out of a Mongo repository. It&#8217;s up to you to encapsulate this further.</p>
</div>
<div class="paragraph">
<p>We have several tests in place and can try to rework our service.</p>
</div>
<div class="paragraph">
<p>Spring Boot supports Spring Data JPA out of the box and you can declare a repository like this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 25. Spring Data JPA repository for the Events</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public interface EventRepository extends Repository&lt;EventEntity, Integer&gt; {
    List&lt;EventEntity&gt; findAllByOrderByHeldOnAsc();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you already know Spring Data you&#8217;ll notice that I don&#8217;t used the <code>JpaRepository</code> interface as I prefer only to declare the methods I actually need and use.</p>
</div>
<div class="paragraph">
<p>The rewritten service based on that repository now looks like this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 26. Rewritten event service</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Service
public class EventService {
    private final EventRepository eventRepository;

    public EventService(EventRepository eventRepository) {
        this.eventRepository = eventRepository;
    }

    public List&lt;EventEntity&gt; allEvents() {
        return this.eventRepository.findAllByOrderByHeldOnAsc();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And our test is still green.</p>
</div>
</div>
<div class="sect3">
<h4 id="_testing_the_service"><a class="anchor" href="#_testing_the_service"></a>Testing the service</h4>
<div class="paragraph">
<p>We have several ways of testing the service. We can either mock the repository (which I usually do), or we can use yet another test slice, that is: <code>@DataJpaTest</code>. <code>@DataJpaTest</code> replaces databases via an embedded Database by default, runs all init scripts or migrations and then runs a transactional test. Transactional tests are rolled back by default:</p>
</div>
</div>
<div class="sect3">
<h4 id="_other_options_to_initialize_a_database"><a class="anchor" href="#_other_options_to_initialize_a_database"></a>Other options to initialize a database</h4>
<div class="paragraph">
<p>Although you can use several <code>schema.sql</code> and <code>data.sql</code> scripts and also relay on JPA to generate your tables, I&#8217;m very sceptic about that. Especially the JPA based migrations work only well if you&#8217;re and your application is in charge of the database. That is: Has the right to change schema at will.</p>
</div>
<div class="paragraph">
<p>The project contains therefor contains a dependency to Flyway (<code>org.flywaydb:flyway-core</code>) core, that takes care of using dedicated scripts to initialize your database. An alternative would be using Liquibase.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_of_spring_boot_applications"><a class="anchor" href="#_configuration_of_spring_boot_applications"></a>6. Configuration of Spring Boot Applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can follow several paradigms to configure a Spring Boot application. You&#8217;re either can relay completely on the environment and let your Spring Boot application adapt itself or you chose profiles or combinations thereof. Either way: In no case you have to build your applications for different environments differently.</p>
</div>
<div class="paragraph">
<p>You should differentiate between external and internal configuration. We speak about internal configuration in regards of beans, context- and dependency injection and so on. External configuration on the other hand basically describes means to change the behavior of your application depending on environment or configuration properties.</p>
</div>
<div class="paragraph">
<p>Internal configuration often depends on external configuration!</p>
</div>
<div class="sect2">
<h3 id="_external_configuration"><a class="anchor" href="#_external_configuration"></a>6.1. External configuration</h3>
<div class="paragraph">
<p>External configuration come from a so called <code>PropertySource</code>. Those property sources can be of various kind and have a well defined order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@TestPropertySource</code> annotations on your tests.</p>
</li>
<li>
<p><code>@SpringBootTest#properties</code> annotation attribute on your tests.</p>
</li>
<li>
<p>Command line arguments</p>
</li>
<li>
<p>Properties from <code>SPRING_APPLICATION_JSON</code> (inline JSON embedded in an environment</p>
</li>
<li>
<p>variable or system property)</p>
</li>
<li>
<p><code>ServletConfig</code> init parameters</p>
</li>
<li>
<p><code>ServletContext</code> init parameters</p>
</li>
<li>
<p>JNDI attributes from <code>java:comp/env</code></p>
</li>
<li>
<p>Java System properties (<code>System.getProperties()</code>)</p>
</li>
<li>
<p>OS environment variables</p>
</li>
<li>
<p>A <code>RandomValuePropertySource</code> that only has properties in <code>random.*</code></p>
</li>
<li>
<p>Profile-specific application properties outside of your packaged jar</p>
</li>
<li>
<p>(<code>application-{profile}.properties</code> and YAML variants)</p>
</li>
<li>
<p>Profile-specific application properties packaged inside your jar (<code>application-{profile}.properties</code> and YAML variants)</p>
</li>
<li>
<p>Application properties outside of your packaged jar (<code>application.properties</code> and YAML variants)</p>
</li>
<li>
<p>Application properties packaged inside your jar (<code>application.properties</code> and YAML variants)</p>
</li>
<li>
<p><code>@PropertySource</code> annotations on your <code>@Configuration</code> classes.</p>
</li>
<li>
<p>Default properties (specified using <code>SpringApplication.setDefaultProperties</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now, open the file <code>application.properties</code>. It corresponds to the <code>default</code> profile and configuration of your application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you&#8217;re a YAML fan, you can use YAML as well.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All IDEs mentioned here support syntax highlighting and auto completion in this file.</p>
</div>
<div class="sect3">
<h4 id="_how_to_use_those_properties"><a class="anchor" href="#_how_to_use_those_properties"></a>How to use those properties?</h4>
<div class="paragraph">
<p>You basically have to options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>@Value</code> annotation that can be used to retrieve any property from the environment.</p>
</li>
<li>
<p>Classes annotated with <code>@ConfigurationProperties</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The second option has several advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can concentrate configuration for one topic in one class, including the possibility to provide defaults</p>
</li>
<li>
<p>The class are subject to relaxed binding</p>
</li>
<li>
<p>They are available as beans in the context</p>
</li>
<li>
<p>They are recognized by a build processor to generate meta data which in turn is helpful for content assist and other</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Given the following pretty arbitrary properties bean:</p>
</div>
<div class="exampleblock">
<div class="title">Example 27. Some arbitrary properties</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
@ConfigurationProperties(prefix = "event-service")
public class EventServiceProperties {
    /**
     * The default number of seats avaiable for each event.
     */
    private Integer defaultNumberOfSeats;

    /**
     * Some arbitrary information.
     */
    private String arbitraryInformation;

    public Integer getDefaultNumberOfSeats() {
        return defaultNumberOfSeats;
    }

    public void setDefaultNumberOfSeats(Integer defaultNumberOfSeats) {
        this.defaultNumberOfSeats = defaultNumberOfSeats;
    }

    public String getArbitraryInformation() {
        return arbitraryInformation;
    }

    public void setArbitraryInformation(String arbitraryInformation) {
        this.arbitraryInformation = arbitraryInformation;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The default number of seats can be configured by any of those:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>event-service.default-number-of-seats = 42</code></p>
</li>
<li>
<p><code>eventService.defaultNumberOfSeats = 42</code></p>
</li>
<li>
<p><code>event_service.default_number_of_seats = 42</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Chose the format that fits the source best: Usually uppercase and underscores works great in environment properties, dashes are good for properties.</p>
</div>
<div class="paragraph">
<p>To provide metadata of this configuration file for you, you&#8217;re IDE and your coworkers add the <code>spring-boot-configuration-processor</code></p>
</div>
<div class="exampleblock">
<div class="title">Example 28. Use the spring-boot-configuration-processor</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
	&lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
	&lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_non_functional_requirements"><a class="anchor" href="#_non_functional_requirements"></a>7. Non functional requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some non functional requirements that usually are requested:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Health information</p>
</li>
<li>
<p>Metrics</p>
</li>
<li>
<p>Context and configuration information</p>
</li>
<li>
<p>Logging</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Spring Boot offers Spring Boot Actuator that can be added as simple dependency:</p>
</div>
<div class="exampleblock">
<div class="title">Example 29. Add Spring Boot Actuator</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
	&lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This provides a several interesting new api endpoints, including the information above.</p>
</div>
<div class="paragraph">
<p>With current Spring Boot they reside directly under the root context:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:8080/health" class="bare">http://localhost:8080/health</a></p>
</li>
<li>
<p><a href="http://localhost:8080/metrics" class="bare">http://localhost:8080/metrics</a></p>
</li>
<li>
<p><a href="http://localhost:8080/info" class="bare">http://localhost:8080/info</a></p>
</li>
<li>
<p><a href="http://localhost:8080/autoconfig" class="bare">http://localhost:8080/autoconfig</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Spring Boot will change that to <code>/application/</code> and you can configure that already today. And while we&#8217;re at it, disable actuator endpoint security as the endpoints are protected by default and since we don&#8217;t have Spring Security yet, there&#8217;s no valid user to authenticate with:</p>
</div>
<div class="exampleblock">
<div class="title">Example 30. Configure Spring Boot actuator</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-properties" data-lang="properties">management.security.enabled = false
# That will be the default with Spring Boot 2.0
management.context-path = /application</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_microservice_scenario"><a class="anchor" href="#_microservice_scenario"></a>8. Microservice Scenario</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The sources contain one microservice scenario which makes use of two projects from the <a href="https://cloud.spring.io/spring-cloud-netflix/">Spring Cloud Netflix</a> portfolio:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It uses Eureka for Service Discovery: Eureka instances can be registered and clients can discover the instances using Spring-managed beans</p>
</li>
<li>
<p>It uses Hystrix as a service breaker: Hystrix clients can be built with a simple annotation-driven method decorator</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is just a demonstration of how one can use those projects. It should not by any means recommend this kind of microservice architecture for all use cases. Its a nice and easy way to demonstrate what you can do with additional Spring projects after finishing your Spring Boot application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The project <code>calendar-service</code> is a client of <code>event-service</code>. In addition there is now <code>service-registry</code>.</p>
</div>
<div class="paragraph">
<p><code>service-registry</code> declares an additional dependency management:</p>
</div>
<div class="exampleblock">
<div class="title">Example 31. Bring in Spring Cloud dependencies</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;dependencyManagement&gt;
	&lt;dependencies&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
			&lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;
			&lt;version&gt;${spring-cloud.version}&lt;/version&gt;
			&lt;type&gt;pom&lt;/type&gt;
			&lt;scope&gt;import&lt;/scope&gt;
		&lt;/dependency&gt;
	&lt;/dependencies&gt;
&lt;/dependencyManagement&gt;

&lt;dependencies&gt;
	&lt;dependency&gt;
		&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
		&lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt;
	&lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And the application is annotated like this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 32. Provide an Eureka server:</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@SpringBootApplication
@EnableEurekaServer
public class ServiceRegistryApplication {

	public static void main(String[] args) {
		SpringApplication.run(ServiceRegistryApplication.class, args);
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Thus the Spring Boot application boots the Eureka instance. In addition it tries to register itself with other instances. As it&#8217;s the only one, disable this:</p>
</div>
<div class="exampleblock">
<div class="title">Example 33. Disable registration with other registry</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-properties" data-lang="properties">server.port = 8761

eureka.client.register-with-eureka = false
eureka.client.fetch-registry = false</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The listing above also sets Springs server port to Eurekas default. You build and run the service registry as usual. If you do this, you&#8217;ll reach a admin interface at <a href="http://localhost:8761">http://localhost:8761</a>.</p>
</div>
<div class="paragraph">
<p>Then back to the event service. Add the same additional dependency management as well as <code>org.springframework.cloud:spring-cloud-starter-eureka-server</code>.</p>
</div>
<div class="paragraph">
<p>Also, give the service a fixed name through configuration:</p>
</div>
<div class="exampleblock">
<div class="title">Example 34. Fixed name for a Spring Boot application</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-properties" data-lang="properties">spring.application.name = event-service</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll now annotate the <code>EventServiceApplication</code> with <code>@EnableDiscoveryClient</code></p>
</div>
<div class="exampleblock">
<div class="title">Example 35. Register a service with the service registry</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-properties" data-lang="properties">@SpringBootApplication
@EnableDiscoveryClient
public class EventServiceApplication {

	public static void main(String[] args) {
		SpringApplication.run(EventServiceApplication.class, args);
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code>@EnableDiscoveryClient</code> enables discovery for Eureka instances by default, but there are also implementations for Zookeeper and other.</p>
</div>
<div class="paragraph">
<p>Imagine the <code>event-service</code> as provider. The additional <code>calendar-service</code> in this repository is a client. The <code>calendar-service</code>  should retrieve all existing events and present them in a calendar widget. It&#8217;s main application class shall also be annotated with <code>@EnableDiscoveryClient</code>.</p>
</div>
<div class="paragraph">
<p>Both services are now registered with Eureka.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll use Springs <code>RestTemplate</code> to synchronously <code>GET</code> <code>/api/events</code> from our event service, but we won&#8217;t be hardcoding the server path and port of the event service. Instead, we&#8217;ll provide a special instance of <code>RestTemplate</code> through the following configuration inside <code>calendar-service</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 36. Provide a load balanced RestTemplate</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Configuration
public class RestTemplateConfig {

    @LoadBalanced
    @Bean
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You see an ordinary configuration class that returns one bean. The method is annotated with <code>@LoadBalanced</code>. <code>@LoadBalanced</code> also comes with <code>spring-cloud-starter-eureka-server</code> and is part of Springs so called Ribbon client. Ribbon is a client side load balancer that knows the connection to the service discovery. If you use <code>@EnableDiscoveryClient</code> with your application and are ok with Ribbons default, you can use it immediately to make your <code>RestTemplate</code> aware of virtual host names.</p>
</div>
<div class="paragraph">
<p>Virtual host names are the names of the applications that are registered with the Eureka service registry instance.</p>
</div>
<div class="paragraph">
<p>The only difference in using the template is the fact, that you have to provide the name of a virtual host instead of a server and port:</p>
</div>
<div class="exampleblock">
<div class="title">Example 37. Using a load balanced RestTemplate</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Service
public class EventService {
    public List&lt;Event&gt; allEvents() {
        final ResponseEntity&lt;List&lt;Event&gt;&gt; response =  this.restTemplate
                .exchange("http://event-service/api/events", HttpMethod.GET, null, new ParameterizedTypeReference&lt;List&lt;Event&gt;&gt;() {
                });
        if(response.getStatusCode() != HttpStatus.OK) {
            throw new RuntimeException("Could not retrieve events");
        }
        return response.getBody();
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And that&#8217;s all! As you see, we have wrapped the call inside a service to which we&#8217;ll come back later.</p>
</div>
<div class="paragraph">
<p>Using the service from with in a controller like this posses a problem though:</p>
</div>
<div class="exampleblock">
<div class="title">Example 38. Using the service above</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Controller
public class IndexController {

    private final EventService eventService;

    public IndexController(EventService eventService) {
        this.eventService = eventService;
    }

    @GetMapping({"/", "index"})
    public String index(final Model model) {
        model.addAttribute("events", this.eventService.allEvents());
        return "index";
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The request against the controller depends on another request from server to server that can fail (and usually will fail some times).</p>
</div>
<div class="paragraph">
<p>There are many different solutions for that topic. One is a technical solution called "circuit breaker", much like a fuse inside your house that opens when an error happens and depending on the fuse will close again, either manually or after some time, trying again.</p>
</div>
<div class="paragraph">
<p>From the Netflix stack there&#8217;s <code>org.springframework.cloud:spring-cloud-starter-hystrix</code> that provides <code>@HystrixCommand</code>. To use those circuit breakers inside your application, they have to be enabled like:</p>
</div>
<div class="exampleblock">
<div class="title">Example 39. Enable circuit breaker</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@SpringBootApplication
@EnableCircuitBreaker
public class CalendarServiceApplication {

	public static void main(String[] args) {
		SpringApplication.run(CalendarServiceApplication.class, args);
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And then it&#8217;s easy to use them. In this case we&#8217;re using the <code>fallbackMethod</code> attribute to define another method that is to be called when the original method fails for some reason:</p>
</div>
<div class="exampleblock">
<div class="title">Example 40. Using a circuit breaker</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@HystrixCommand(fallbackMethod = "emptyEvents")
public List&lt;Event&gt; allEvents() {
    // As above make call to remote server
    return response.getBody();
}

List&lt;Event&gt; emptyEvents() {
    return new ArrayList&lt;&gt;();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Depending on other settings, Hystrix will keep the circuit open for some time, than close and try again.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Take care in a production system to adapt Hystrix timeouts to Ribbon clients timeouts.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That may works when a service depends on one remote call, but having different calls, it gets hard very fast to manage. A better solution for that may be architectures that invert the relation ship: Whereas we&#8217;ll keep the events as a resource, that resources is polled in some sane interval and events are stored redundant in the calendar service.</p>
</div>
<div class="paragraph">
<p>Changes from the calendar service to events can be communicated maybe through an event bus.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_wrap_up"><a class="anchor" href="#_wrap_up"></a>9. Wrap up</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have managed to setup one of many possible micro service architectures in about 4 hours.</p>
</div>
<div class="paragraph">
<p>You can run them independent now each as explained in the beginning and than hit <a href="http://localhost:8088" class="bare">http://localhost:8088</a> for the calendar service or use the provided docker images as follows (given a valid Docker installation on your machine)</p>
</div>
<div class="paragraph">
<p>Build everything with either <code>build.sh</code> or <code>build.bat</code>. That will use <a href="https://github.com/fabric8io/docker-maven-plugin">Docker Maven Plugin</a> to provide three images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>msimons/ws-cluj-calendar-service</p>
</li>
<li>
<p>msimons/ws-cluj-event-service</p>
</li>
<li>
<p>msimons/ws-cluj-service-registry</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Which are orchestrated via the following <code>docker-compose.yml</code></p>
</div>
<div class="exampleblock">
<div class="title">Example 41. Orchestrate docker images via docker-compose</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yml" data-lang="yml">version: '2'

services:
  calendar-service:
    image: msimons/ws-cluj-calendar-service
    ports:
      - "8080:8080"
    depends_on:
      - service-registry
      - event-service
    environment:
      - server.port=8080
      - eureka.client.serviceUrl.defaultZone=http://service-registry:8761/eureka/

  event-service:
    image: msimons/ws-cluj-event-service
    depends_on:
      - service-registry
      - database
    environment:
      - server.port=8080
      - spring.profiles.active=prod
      - spring.datasource.url=jdbc:postgresql://database:5432/events-db
      - eureka.client.serviceUrl.defaultZone=http://service-registry:8761/eureka/
    expose:
      - "8080"

  service-registry:
    image: msimons/ws-cluj-service-registry
    expose:
     - "8761"

  database:
      image: postgres:9.6
      environment:
          - POSTGRES_USER=events-db
          - POSTGRESS_PASSWORD=events-db</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Notice how some properties of your applications in the containers can easily changed through dockers environment setting. For example we have to configure Eurekas default zone now with <code>eureka.client.serviceUrl.defaultZone</code> as Eureka doesn&#8217;t run on the same host anymore.</p>
</div>
<div class="paragraph">
<p>Run everything now with <code>docker-compose up</code> and the calendar service is reachable as a frontend for the whole system under <a href="http://localhost:8080" class="bare">http://localhost:8080</a>.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0<br>
Last updated 2017-06-30 16:50:00 CEST
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>
</body>
</html>